<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
      <title>INV{{ invoice.id|stringformat:'04d'}} {{ invoice.member }} </title>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"></script>
      <style>
        @media print
          {    
              .no-print, .no-print *
              {
                  display: none !important;
              }
          }

            table.print-friendly tr td, table.print-friendly tr th {
                page-break-inside: avoid;
            }
        </style>
    </head>
  <body style="background-color:whitesmoke">
    <div style="left:0; position:relative; width:210mm; margin: 0mm auto; background-color:white; padding:0mm 5mm">
      <!--#region header -->
      <span style="display:flex; justify-content:space-between;">
        <span style="font-size:4rem; text-transform:uppercase; font-weight:600">{{ library.name }}</span>
        <span>
          <br>
          <span style="font-size:1.5rem">INV{{ invoice.id|stringformat:'04d'}}</span>
        </span>
      </span>
      <span style="text-transform:uppercase;">
        <span style="font-size:1.4rem">{{ member.user.first_name }} {{ member.user.last_name }}</span><br>
      </span>
      <!--#endregion -->

      <span style="display:flex; justify-content:space-between; width:100%">
        <span>
          <em>To</em><br>
          <span style="font-size:1.4rem">{{ invoice.member.user.first_name }} {{ invoice.member.user.last_name }}</span><br>
          <!--#region address -->
            <span style="font-size:1rem">
              {% if invoice.member.address.c_o %}
                {{ invoice.member.address.c_o }}<br>
              {% endif %}
              {% if invoice.member.address.unit_number %}
                {{ invoice.member.address.unit_number }} / 
              {% endif %}
              {{ invoice.member.address.street_number }} {{ invoice.member.address.street_name }}<br>
              {{ invoice.member.address.suburb }}<br>
              {{ invoice.member.address.city }} {{ invoice.member.address.post_code }}<br>
            </span>
          <!--#endregion -->
        </span>
        
        <span>
          <em>From</em><br>
          <span style="font-size:1.4rem">{{ invoice.library.library_shop.member.address.first_name }} {{ invoice.library.library_shop.member.address.last_name }}</span><br>
          <!--#region address -->
            <span style="font-size:1rem">
              {% if invoice.library.library_shop.member.address.include_first_and_last_names == True %}
                {{ invoice.library.library_shop.member.address.first_name }} {{ invoice.library.library_shop.member.address.last_name }}<br>
              {% endif %}
              {% if invoice.library.library_shop.member.address.c_o %}
                {{ invoice.library.library_shop.member.address.c_o }}<br>
              {% endif %}
              {% if invoice.library.library_shop.member.address.unit_number %}
                {{ invoice.library.library_shop.member.address.unit_number }} / 
              {% endif %}
              {{ invoice.library.library_shop.member.address.street_number }} {{ invoice.library.library_shop.member.address.street_name }}<br>
              {{ invoice.library.library_shop.member.address.suburb }}<br>
              {{ invoice.library.library_shop.member.address.city }} {{ invoice.library.library_shop.member.address.post_code }}<br>
              <br>
              GST# {{ invoice.library.gst }}
            </span>
          <!--#endregion -->
        </span>
      </span>

      <span class="no-print"><a href="{% url 'return_to_member_dashboard' library.id invoice.member.id %}" class="btn btn-sm btn-secondary">Return to Dashboard</a></span>
      <!--#region items -->
        <span style="margin-top:10mm; display:flex; justify-content:center; width:100%">
          <table class="table table-borderless" style="font-size:0.7rem">
            <!--#region table headers -->
              <thead>
                <tr>
                  <th colspan="3">Release</th>
                  <th>Artist</th>
                  <th>Title</th>
                  <th>Label</th>
                  <th class="text-center">Price</th>
                  <th class="text-center">Quantity</th>
                  <th style="text-align:right">Sub T.</th>
                </tr>
              </thead>
            <!--#endregion -->
            <tbody>
              <!--#region items line by line -->
                {% for item in invoice_items %}
                  <tr>
                    <!--#region artwork -->
                      <td style="height:30px; width: 30px; text-align:center;">
                        {% if item.order_request_item.vinyl_release.artwork_small %}
                            <img src="{{ item.order_request_item.vinyl_release.artwork_small.url }}" width="20" height="20">
                        {% else %}
                          <div style="text-align:center; font-size: 0.5rem;">No image</div>
                        {% endif %}
                      </td>
                    <!--#endregion -->
                    <td>{{ item.order_request_item.vinyl_release.catalog_number }}</td>
                    <!--#region release type -->
                    {% if item.order_request_item.vinyl_release.plate_count == 1 %}
                      <td class="text-center">{{ item.order_request_item.vinyl_release.plate_size }}</td>
                    {% else %}
                      <td class="text-center">{{ item.order_request_item.vinyl_release.plate_count }}x{{ item.order_request_item.vinyl_release.plate_size }}</td>
                    {% endif %}
                    <!--#endregion -->
                    <td>{{ item.order_request_item.vinyl_release.artist }}</td>
                    <td>{{ item.order_request_item.vinyl_release.release_title }}</td>
                    <td>{{ item.order_request_item.vinyl_release.label }}</td>
                    <td class="text-center">{{ item.invoiced_sale_price }}</td>
                    <td class="text-center">{{ item.invoiced_quantity }}</td>
                    <td style="text-align:right">{{ item.invoiced_sub_total }}</td>
                  </tr>
                {% endfor %}
              <!--#endregion -->
              
              <!--#region shipping, sub total, gst & total -->

                <tr style="font-size:1rem">
                  <td colspan="8" style="text-align:right">Sub Total (Excl. GST): </td>
                  <td style="text-align:right">{{ invoice.invoice_sub_total }}</td>
                </tr>
                <tr style="font-size:1rem">
                  <td colspan="8" style="text-align:right">Shipping ({{ invoice.invoice_shipping_type }}):</td>
                  <td style="text-align:right">{{ invoice.invoice_shipping_cost }}</td>
                </tr>
                <tr style="font-size:1rem">
                  <td colspan="8" style="text-align:right">GST: </td>
                  <td style="text-align:right">{{ invoice.invoice_total_gst }}</td>
                </tr>
                
                <tr style="font-weight:600; font-size:1rem">
                  <td colspan="8" style="text-align:right">Total: </td>
                  <td style="text-align:right">{{ invoice.invoice_total }}</td>
                </tr>
              <!--#endregion -->
              {% if invoice.member_has_made_payment == False %}
              <tr class="no-print">
                <td colspan="9" style="text-align:right">
                  <a href="{% url 'invoice_member_has_payed_submission' library.id invoice.id %}" class="btn btn-sm btn-secondary">Click me to let {{ library }} know you have paid this invoice</a>
                </td>
              </tr>
              <tr>
                <td colspan="9" style="text-align:right">
                  Please pay ${{ invoice.invoice_total }} to {{ library }}, 01-0804-0187544-48<br>
                  Name: Tristan Maxwell<br>
                  Reference: INV{{ invoice.id|stringformat:"04d" }}<br>
                  {{ library }} GST Number: {{ library.gst }}
                </td>
              </tr>
              {% elif invoice.paid %}
              <tr>
                <td colspan="9" style="text-align:right; font-size:1rem">
                  Thank you, {{ library }} has received your payment of this invoice.
                </td>
              </tr>
              {% else %}
              <tr>
                <td colspan="9" style="text-align:right; font-size:1rem">
                  Thank you, you have made the payment for this invoice.<br>
                  {{ library }} will let you know if there is any issues.
                </td>
              </tr>
              {% endif %}
            </tbody>
          </table>
        </span>
    </div>
  </body>
</html>