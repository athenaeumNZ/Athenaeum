<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
      <title>{{ order_request.member }} OR{{ order_request.id|stringformat:"04d" }}</title>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"></script>
      <style>
        @media print
          {    
              .no-print, .no-print *
              {
                  display: none !important;
              }
          }
      </style>
    </head>
  <body style="background-color:whitesmoke">
    <div style="left:0; position:relative; width:210mm; height:297mm; margin: 0mm auto; background-color:white; padding:0mm 5mm">
      <!--#region header -->
      <span style="display:flex;text-transform:uppercase; align-items: center;">
        <span style="font-size:4rem"><strong>{{ order_request.library.name }}</strong>
        </span>
        <span style="padding-left:10mm; font-size:1.5rem">
          Order Request OR{{ order_request.id|stringformat:"04d" }}
        </span>
        <br>
      </span>
      <span style="text-transform:uppercase;">
        <span style="font-size:1.4rem">{{ order_request.member.user.first_name }} {{ order_request.member.user.last_name }}</span><br>
        <span>{{ order_request.created|date:"d M Y" }}</span>
      </span>
      <span style="float:right" class="no-print">
        <a href="{% url 'order_request_delete_submission' library.id order_request.id %}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to DELETE this order request?')"><i class="fas fa-skull-crossbones"></i></a>
        {% if order_request.archived == False %}
          <a href="{% url 'order_request_archive_submission' library.id order_request.id %}" class="btn btn-sm btn-warning" onclick="return confirm('Are you sure you want to ARCHIVE this order request?')">Archive</a>
        {% endif %}
        </span>
      <!--#endregion -->

      <!--#region items -->
        <span style="margin-top:10mm; display:flex; justify-content:center; width:100%">
          <table class="table" style="font-size:0.7rem">
            <thead>
              <tr>
                <th colspan="3">Catalog Number</th>
                <th>Artist</th>
                <th>Title</th>
                <th>Label</th>
                <th class="text-center">Date</th>
                <th class="text-center">Q</th>
                <th class="text-center no-print">Ordered</th>
                <th class="text-center no-print">Stockpiled</th>
              </tr>
            </thead>
            <tbody>
              {% for item in order_request_items %}
                <tr>
                  <!--#region artwork -->
                    <td style="height:30px; width: 30px; text-align:center;">
                      <a href="{% url 'release' library.id item.vinyl_release.id %}" target="_blank">
                        {% if item.vinyl_release.artwork_small %}
                          <img src="{{ item.vinyl_release.artwork_small.url }}" width="20" height="20">
                        {% else %}
                          <div style="text-align:center; font-size: 0.5rem;">No image</div>
                        {% endif %}
                      </a>
                    </td>
                  <!--#endregion -->
                  <!--#region catalog -->
                    <td>{{ item.vinyl_release.catalog_number }}</td>
                  <!--#endregion -->
                  <!--#region release type -->
                    {% if item.vinyl_release.plate_count == 1 %}
                      <td class="text-center">{{ item.vinyl_release.plate_size }}</td>
                    {% else %}
                      <td class="text-center">{{ item.vinyl_release.plate_count }}x{{ item.vinyl_release.plate_size }}</td>
                    {% endif %}
                  <!--#endregion -->
                  <!--#region artist, title, label, release date-->
                  <td>{{ item.vinyl_release.artist }}</td>
                  <td>{{ item.vinyl_release.release_title }}</td>
                  <td>{{ item.vinyl_release.label }}</td>
                  <td class="text-center">{{ item.vinyl_release.release_date|date:"d m" }}</td>
                  <!--#endregion -->
                  <!--#region adjust quantity -->
                    <td  class="text-center">
                      <a href="{% url 'order_request_item_update' library.id order_request.id item.id previous_url %}" style="color:black; text-decoration:none">{{ item.quantity }}</a>
                    </td>
                  <!--#endregion -->
                  <!--#region ordered -->
                    
                      <td class="text-center no-print">
                        {% if item.shop_purchase == True %}
                          <a href="http://127.0.0.1:8000/members/1" target="_blank"><button>RESTOCK</button></a>

                        {% elif item.ordered %}
                          <i class="fas fa-check" style="color:green; font-size:0.5rem;"></i>
                        {% else %}
                          <a href="{% url 'order_request_item_order_submission' library.id order_request.id item.id %}"><i class="fas fa-times" style="color:red; font-size:0.5rem"></i></a>
                        {% endif %}
                      </td>
                  <!--#endregion -->
                  <!--#region stockpiled -->
                    {% if item.stockpiled %}
                      <td class="text-center no-print"><i class="fas fa-check" style="color:green; font-size:0.5rem;"></i></td>
                    {% else %}
                      <td class="text-center no-print"><i class="fas fa-times" style="color:red; font-size:0.5rem"></i></td>
                    {% endif %}
                  <!--#endregion -->   
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </span>
      <!--#endregion -->
      
      {% if order_request.all_ordered == False %}
        <span class="no-print" style="margin-top:50mm; width:100%">
          <a href="{% url 'order_request_items_order_items_submission' library.id order_request.id %}" class="btn btn-sm btn-secondary" style="float:right">Order All</a>
        </span>
      {% endif %}
    </div>
  </body>
</html>